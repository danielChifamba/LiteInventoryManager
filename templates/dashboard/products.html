{% extends "components/main/base.html" %}
{% load static %}
{% block customCSS %}
<link rel=stylesheet href="{% static 'styles/table.css' %}"><link rel=stylesheet href="{% static 'styles/products.css' %}">{% endblock customCSS %}
{% block title %}<title>{{ business.business_name }} - Products</title>{% endblock title %}
{% block content %}<main><style>input{display:none}</style>{% include 'components/main/alert.html' %}<h1 class=title>Products</h1><hr><div class=container-fluid><div class="container action d-flex gap-2 justify-content-end"><button class="btn btn-primary mb-3" data-bs-toggle=modal data-bs-target=#addProductModal>Add Product</button>
<a class="btn btn-success mb-3" onclick=triggerFileUpload()>Import</a><form id=upload-form method=post enctype=multipart/form-data action="{% url 'dashboard:import_products' %}">{% csrf_token %}
<input type=file name=file id=file-input accept=.xls class='form-control mt-3' style=display:none></form><input type=file name=file accept=.xls>
<a href="{% url 'dashboard:export_products' %}" class="btn btn-warning mb-3">Export</a></div><div class="container-fluid rounded-4 p-2"><div class="container d-flex align-items-center justify-content-end my-2"><form class="d-flex position-relative" role=search><input class="form-control me-2" type=search placeholder=Search aria-label=Search></form></div><table class="table table-striped border">{% if products %}<thead class=thead-primary><tr><th>SKU<th>Name<th>Category<th>Description<th>Quantity<th>Cost Price<th>Selling Price<th>Profit Margin<th>Action<tbody>{% for product in products %}<tr><td>{{ product.sku }}<td>{{ product.name }}<td>{{ product.category }}<td class="desc position-relative">{{ product.description|truncatechars:20 }}<ul class="pop description"><p class=lead>{{ product.description }}</ul><td>{{ product.stock_quantity }}<td>{{ business.currency_symbol }}{{ product.cost_price }}<td>{{ business.currency_symbol }}{{ product.selling_price }}<td>{{ product.get_profit_margin|floatformat:2 }}%<td class=d-flex><form hx-post="{% url 'dashboard:get_product' product.sku %}" hx-target=#productUpdateContainer>{% csrf_token %}
<button class="btn btn-sm edit action" data-bs-toggle=modal data-bs-target=#updateProductModal><i class="bi bi-pencil color-warning"></i></button></form><form hx-post="{% url 'dashboard:get_product_delete' product.sku %}" hx-target=#productDeleteContainer>{% csrf_token %}
<button class="btn btn-sm delete action" data-bs-toggle=modal data-bs-target=#warningModal><i class="bi bi-trash color-danger"></i></button></form>{% endfor %}
{% else %}<div class="d-flex align-items-center justify-content-center p-2 rounded-3 bg-grey"><div class=lead>No product available</div></div>{% endif %}</table></div></div></main>{% include 'components/dashboard/productsModal.html' %}
{% endblock content %}
{% block customJS %}
<script src="{% static 'utils/product.js' %}"></script>{% endblock customJS %}